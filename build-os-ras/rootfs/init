#!/bin/sh

# Mount essential filesystems
mount -t proc proc /proc
mount -t sysfs sysfs /sys  
mount -t devtmpfs devtmpfs /dev 2>/dev/null

# Run initialization
/etc/init.d/rcS

# Spawn shell directly on console
echo "Starting shell on serial console..."

# Loop to respawn shell if it exits
while true; do
    setsid sh -c 'exec sh </dev/ttyAMA0 >/dev/ttyAMA0 2>&1' || true
    sleep 1
done
