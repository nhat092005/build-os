#!/bin/sh
# Load kernel modules

start() {
    modprobe cfg80211 2>/dev/null
    modprobe brcmutil 2>/dev/null
    modprobe brcmfmac 2>/dev/null
    sleep 1
    [ -e /sys/class/net/wlan0 ] && echo "WiFi modules loaded"
}

stop() {
    rmmod brcmfmac 2>/dev/null
    rmmod brcmutil 2>/dev/null
    rmmod cfg80211 2>/dev/null
}

case "$1" in
    start) start ;;
    stop) stop ;;
    restart) stop; sleep 1; start ;;
    *) echo "Usage: $0 {start|stop|restart}"; exit 1 ;;
esac
